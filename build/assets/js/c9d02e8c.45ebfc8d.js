"use strict";(self.webpackChunkur_wave_doc=self.webpackChunkur_wave_doc||[]).push([[459],{1341:(e,n,s)=>{s.d(n,{A:()=>r});var t=s(6540),i=s(4848);const r=e=>{let{title:n="My Browser",url:s="http://localhost:3000",language:r="text",children:l}=e;const[o,a]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");a(e.matches);const n=e=>{a(e.matches)};return e.addEventListener("change",n),()=>e.removeEventListener("change",n)}),[]);const d={border:"1px solid #ccc",borderRadius:"10px",width:"100%",maxWidth:"100%",margin:"0",boxShadow:"0px 4px 8px rgba(0,0,0,0.1)",background:o?"#333":"#fff",color:o?"#fff":"#000"},c={background:o?"#222":"#f3f3f3",padding:"8px",display:"flex",alignItems:"center",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",justifyContent:"space-between"},h={flexGrow:1,background:o?"#444":"#fff",padding:"4px 10px",margin:"0 10px",borderRadius:"6px",fontSize:"12px",color:o?"#ddd":"#333",textAlign:"center",border:"1px solid #ddd",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},p={padding:"16px",background:o?"#222":"#fff",overflow:"auto",color:o?"#fff":"#000"};return(0,i.jsxs)("div",{style:d,children:[(0,i.jsxs)("div",{style:c,children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,i.jsx)("span",{style:{background:"#ff5f57",width:"12px",height:"12px",borderRadius:"50%"}}),(0,i.jsx)("span",{style:{background:"#ffbd2e",width:"12px",height:"12px",borderRadius:"50%"}}),(0,i.jsx)("span",{style:{background:"#28c840",width:"12px",height:"12px",borderRadius:"50%"}}),(0,i.jsx)("span",{style:{fontSize:"14px",fontWeight:"bold",marginLeft:"8px"},children:n})]}),(0,i.jsx)("div",{style:h,children:s}),(0,i.jsx)("div",{style:{background:o?"#555":"#e0e0e0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",color:o?"#ccc":"#666"},children:r})]}),(0,i.jsx)("div",{style:p,children:(0,i.jsx)("pre",{style:{margin:0},children:(0,i.jsx)("code",{className:`language-${r}`,children:l})})})]})}},2057:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/PostmanHeader-3ec78585d951d40b592abc943836e313.PNG"},3178:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/AspireDashboard-37d4bc1254c0280ab4dd0ff3e4898408.PNG"},3875:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/Token-50d7a762aeda4f88baa6d12257f10300.PNG"},4159:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/Aspire-4a17498a09b6ce9674d8b5b3fd1fa153.png"},6107:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/response-d2ec4cda1d21db5d2f6f89d5ab06354f.PNG"},6152:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"tutorial-basics/create-server-page","title":"1 - Server-Side","description":"Introduction","source":"@site/docs/tutorial-basics/create-server-page.md","sourceDirName":"tutorial-basics","slug":"/tutorial-basics/create-server-page","permalink":"/docs/tutorial-basics/create-server-page","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tutorial-basics/create-server-page.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Tutorial - Basics","permalink":"/docs/category/tutorial---basics"},"next":{"title":"2 - Client-Side","permalink":"/docs/tutorial-basics/create-client-page"}}');var i=s(4848),r=s(8453),l=s(1341);const o={sidebar_position:1},a="1 - Server-Side",d={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Creating the Book Module",id:"creating-the-book-module",level:2},{value:"Entity Creation",id:"entity-creation",level:3},{value:"Database Configuration",id:"database-configuration",level:3},{value:"Permission Setup Guide",id:"permission-setup-guide",level:3},{value:"1. Add permissions to <code>TenantPermissions.cs</code>",id:"1-add-permissions-to-tenantpermissionscs",level:4},{value:"2. Update JSON Files for Seeding",id:"2-update-json-files-for-seeding",level:4},{value:"Important Notes:",id:"important-notes",level:4},{value:"a. Update <code>PermissionGroups.json</code>",id:"a-update-permissiongroupsjson",level:5},{value:"b. Update <code>Permissions.json</code>",id:"b-update-permissionsjson",level:5},{value:"c. Update <code>Roles.json</code>",id:"c-update-rolesjson",level:5},{value:"d. Update <code>RolePermissions.json</code>",id:"d-update-rolepermissionsjson",level:5},{value:"3. Apply Changes",id:"3-apply-changes",level:4},{value:"Adding Feature to System",id:"adding-feature-to-system",level:2},{value:"Update JSON Files for Feature Seeding",id:"update-json-files-for-feature-seeding",level:3},{value:"Important Notes:",id:"important-notes-1",level:4},{value:"a. Update <code>Features.json</code>",id:"a-update-featuresjson",level:5},{value:"b. Update <code>FeatureRoles.json</code>",id:"b-update-featurerolesjson",level:5},{value:"Apply Changes",id:"apply-changes",level:4},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Localization",id:"localization",level:2},{value:"Testing (Optional)",id:"testing-optional",level:2},{value:"Testing Steps:",id:"testing-steps",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"1---server-side",children:"1 - Server-Side"})}),"\n","\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"Welcome to the Server-Side Development Guide for our platform!"}),"\n",(0,i.jsx)(n.p,{children:"This guide will walk you through building a complete module in our system using the Book Store example. Whether you're new to our stack or just need a refresher, we've got you covered!"}),"\n",(0,i.jsx)(n.p,{children:"You'll learn how to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 Set up the module structure"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Implement CRUD operations (Create, Read, Update, Delete)"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Apply proper validations to ensure data integrity"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Support multi-tenancy so the system can handle multiple organizations smoothly"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Follow best practices for maintainable and scalable code"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"By the end of this guide, you'll have a fully functional module and a solid understanding of how server-side development works in our platform."}),"\n",(0,i.jsx)(n.admonition,{title:"Advice",type:"tip",children:(0,i.jsxs)(n.p,{children:["Start with Architecture part of the ",(0,i.jsx)(n.a,{href:"/docs/architecture",children:"Architecture Guide"})," to get a better understanding of the platform's architecture."]})}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"Before starting module development, ensure you have:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Access to the UW Platform solution"}),"\n",(0,i.jsx)(n.li,{children:"SQL Server installed"}),"\n",(0,i.jsx)(n.li,{children:"Entity Framework Core tools"}),"\n",(0,i.jsx)(n.li,{children:"Required development environment setup"}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"creating-the-book-module",children:"Creating the Book Module"}),"\n",(0,i.jsx)(n.h3,{id:"entity-creation",children:"Entity Creation"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create the Book entity in the Domain layer (",(0,i.jsx)(n.code,{children:"UW.Platform.Domain.Entities"}),"):"]}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class Book : AuditableEntityBase, IMultiTenantEntity\r\n{\r\n    [MaxLength(StringLength.L50)]\r\n    [Column(Order = 1)]\r\n    public string Name { get; set; } = null!;\r\n    [Column(Order = 2)]\r\n    public BookTypeEnum Type { get; set; }\r\n    [Column(Order = 3)]\r\n    public DateTime PublishDate { get; set; }\r\n    [Column(Order = 4)]\r\n    public decimal Price { get; set; }\r\n    [Column(Order = 5)]\r\n    public int? TenantId { get; set; }\r\n    public Tenant? Tenant { get; set; }\r\n}\n"})})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"[Column(Order = Number)]"})," property is used to define the order of columns in the database table."]})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Create the BookTypeEnum in ",(0,i.jsx)(n.code,{children:"UW.Platform.Domain.Enums"}),":"]}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'public enum BookTypeEnum\r\n{\r\n    [Description("Undefined")]\r\n    Undefined,\r\n    [Description("Adventure")]\r\n    Adventure,\r\n    [Description("Biography")]\r\n    Biography,\r\n    // ... other types\r\n}\n'})})}),"\n",(0,i.jsx)(n.h3,{id:"database-configuration",children:"Database Configuration"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Add Book entity to ",(0,i.jsx)(n.code,{children:"IAppDbContext"}),":"]}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public interface IAppDbContext\r\n{\r\n    public DbSet<Book> Books { get; set; }\r\n    // ... other entities\r\n}\n"})})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Add configuration to ",(0,i.jsx)(n.code,{children:"AppDbContext"}),":"]}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"    public virtual DbSet<Book> Books { get; set; }\n"})})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["Add entity configuration in ",(0,i.jsx)(n.code,{children:"EntityConfigurations"})," (optional):"]}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class BookConfiguration : IEntityTypeConfiguration<Book>\r\n{\r\n    public void Configure(EntityTypeBuilder<Book> builder)\r\n    {\r\n        builder.HasIndex(x => x.Name)\r\n            .IsUnique(false);\r\n    }\r\n}\n"})})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Open Terminal and Create and apply migration:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"in terminal",language:"bash",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"dotnet ef migrations add Create_Book_Entity --context AppDbContext --project src\\UW.Platform.Migrator --startup-project src\\UW.Platform.Migrator --output-dir Data\\AppDb\n"})})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["You can check Batches in ",(0,i.jsx)(n.code,{children:" etc/batches/Run-Migrations.bat"})," to  run migrations automatically or run the next command."]})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Update database:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"in terminal",language:"bash",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"dotnet ef database update --context AppDbContext --project src\\UW.Platform.Migrator --startup-project src\\UW.Platform.Migrator\n"})})}),"\n",(0,i.jsx)(n.h3,{id:"permission-setup-guide",children:"Permission Setup Guide"}),"\n",(0,i.jsx)(n.p,{children:"This guide outlines the steps required to set up new permissions for your project."}),"\n",(0,i.jsxs)(n.h4,{id:"1-add-permissions-to-tenantpermissionscs",children:["1. Add permissions to ",(0,i.jsx)(n.code,{children:"TenantPermissions.cs"})]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'public static class TenantPermissions\r\n{\r\n    public static class Books\r\n    {\r\n        public const string Default = $"{GroupName}.Books";\r\n\r\n        public const string Add = $"{Default}.Create";\r\n\r\n        public const string Update = $"{Default}.Update";\r\n\r\n        public const string Delete = $"{Default}.Delete";\r\n    }\r\n}\n'})})}),"\n",(0,i.jsx)(n.h4,{id:"2-update-json-files-for-seeding",children:"2. Update JSON Files for Seeding"}),"\n",(0,i.jsxs)(n.p,{children:["The seeder depends on JSON files. To add new permissions, you need to update the following JSON files in the ",(0,i.jsx)(n.code,{children:"UW.Platform.Migrator.Seeders.AppDb.InitialData"})," directory:"]}),"\n",(0,i.jsx)(n.h4,{id:"important-notes",children:"Important Notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'For any JSON file you modify, change its "Copy to Output Directory" property to "Copy always" in the Properties Window (Alt + Enter)'}),"\n",(0,i.jsx)(n.li,{children:"After modifying JSON files, rebuild the migrator project"}),"\n",(0,i.jsxs)(n.li,{children:["Run the batch file in ",(0,i.jsx)(n.code,{children:"etc/batches/Run-Migrations.bat"})," to apply the seeding data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't forget commas"})," between JSON objects - missing commas will result in empty tables"]}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"a-update-permissiongroupsjson",children:["a. Update ",(0,i.jsx)(n.code,{children:"PermissionGroups.json"})]}),"\n",(0,i.jsx)(n.p,{children:"Add a new permission group:"}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "Id": 44,\r\n  "Name": "Book Management",\r\n  "PermissionType": 2\r\n}\n'})})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," PermissionType values:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"1 = Host"}),"\n",(0,i.jsx)(n.li,{children:"2 = Tenant"}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"b-update-permissionsjson",children:["b. Update ",(0,i.jsx)(n.code,{children:"Permissions.json"})]}),"\n",(0,i.jsx)(n.p,{children:"Add new permissions:"}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "Id": 3351,\r\n  "Key": "T.Books",\r\n  "Name": "Read Books list and details",\r\n  "PermissionType": "Tenant",\r\n  "PermissionGroupId": 44\r\n},\r\n{\r\n  "Id": 3352,\r\n  "Key": "T.Books.Add",\r\n  "Name": "Add Books",\r\n  "PermissionType": "Tenant",\r\n  "PermissionGroupId": 44\r\n},\r\n{\r\n  "Id": 3353,\r\n  "Key": "T.Books.Update",\r\n  "Name": "Update Books",\r\n  "PermissionType": "Tenant",\r\n  "PermissionGroupId": 44\r\n},\r\n{\r\n  "Id": 3354,\r\n  "Key": "T.Books.Delete",\r\n  "Name": "Delete Books",\r\n  "PermissionType": "Tenant",\r\n  "PermissionGroupId": 44\r\n}\n'})})}),"\n",(0,i.jsx)(n.h3,{id:""}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"CustomIdentity"})," attribute is used to assign a unique identifier to each permission. Host permissions are assigned ",(0,i.jsx)(n.code,{children:"1000"})," and tenant permissions are assigned ",(0,i.jsx)(n.code,{children:"2000"})," and above."]})]}),"\n",(0,i.jsxs)(n.admonition,{type:"warning",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsxs)(n.p,{children:["Increment The ",(0,i.jsx)(n.code,{children:"CustomIdentity"})," by 100 for each new permission."]})]}),"\n",(0,i.jsxs)(n.h5,{id:"c-update-rolesjson",children:["c. Update ",(0,i.jsx)(n.code,{children:"Roles.json"})]}),"\n",(0,i.jsx)(n.p,{children:"Add a new role:"}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "Id": 21,\r\n  "Name": "books app",\r\n  "NormalizedName": "BOOKS APP",\r\n  "DisplayName": "Books Application",\r\n  "Description": "Books Application",\r\n  "RoleType": "Tenant"\r\n}\n'})})}),"\n",(0,i.jsxs)(n.h5,{id:"d-update-rolepermissionsjson",children:["d. Update ",(0,i.jsx)(n.code,{children:"RolePermissions.json"})]}),"\n",(0,i.jsx)(n.p,{children:"Map the new role to its permissions:"}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "Id": 144,\r\n  "RoleId": 21,\r\n  "PermissionId": 3351\r\n},\r\n{\r\n  "Id": 145,\r\n  "RoleId": 21,\r\n  "PermissionId": 3352\r\n},\r\n{\r\n  "Id": 146,\r\n  "RoleId": 21,\r\n  "PermissionId": 3353\r\n},\r\n{\r\n  "Id": 147,\r\n  "RoleId": 21,\r\n  "PermissionId": 3354\r\n}\n'})})}),"\n",(0,i.jsx)(n.h4,{id:"3-apply-changes",children:"3. Apply Changes"}),"\n",(0,i.jsx)(n.p,{children:"After updating all JSON files:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Make sure all modified JSON files have "Copy to Output Directory" set to "Copy always"'}),"\n",(0,i.jsx)(n.li,{children:"Rebuild the migrator project"}),"\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"etc/batches/Run-Migrations.bat"})," to apply the seeding data"]}),"\n",(0,i.jsx)(n.li,{children:"After seeding is complete, remember to return the 'Copy to Output Directory' property back to its original setting in all JSON files"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"adding-feature-to-system",children:"Adding Feature to System"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Update ",(0,i.jsx)(n.code,{children:"AppFeatures.cs"}),":"]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.p,{children:["We have integrated this module into the system's feature list, allowing it to be treated as an optional feature. This enables tenants to ",(0,i.jsx)(n.code,{children:"subscribe"})," to the module if they wish to include it in their platform."]}),(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"[CustomIdentity((int)FeatureEnum.Books)]"})," is used to assign a unique identifier to each feature by the number that we have assigned to the enum feature next."]})})]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'public static class AppFeatures\r\n{\r\n    [CustomIdentity((int)FeatureEnum.Books)]\r\n    [CustomDisplayName("Books Feature")]\r\n    [Description("Books Feature")]\r\n    [FeatureLimits(LimitTypeEnum.NoLimits, 0, "")]\r\n    public const string Books = "Books";\r\n}\n'})})}),"\n",(0,i.jsxs)(n.admonition,{type:"danger",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsxs)(n.p,{children:["Make sure to add the new feature to the ",(0,i.jsx)(n.code,{children:"FeatureEnum"})," enum and assign a unique identifier to it to avoid conflicts with existing features."]})]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Update enum in ",(0,i.jsx)(n.code,{children:"FeatureEnum"})]}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public enum FeatureEnum\r\n{\r\n    Sms = 1,\r\n    Contacts = 2,\r\n    Whatsapp = 3,\r\n    ....\r\n    Books = 4, // Added for Books with unique id `4`\r\n}\n"})})}),"\n",(0,i.jsx)(n.h3,{id:"update-json-files-for-feature-seeding",children:"Update JSON Files for Feature Seeding"}),"\n",(0,i.jsxs)(n.p,{children:["Similar to the permissions setup, you need to update the JSON files for features. These files are also located in the ",(0,i.jsx)(n.code,{children:"UW.Platform.Migrator.Seeders.AppDb.InitialData"})," directory:"]}),"\n",(0,i.jsx)(n.h4,{id:"important-notes-1",children:"Important Notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'For any JSON file you modify, change its "Copy to Output Directory" property to "Copy always" in the Properties Window (Alt + Enter)'}),"\n",(0,i.jsx)(n.li,{children:"After modifying JSON files, rebuild the migrator project"}),"\n",(0,i.jsxs)(n.li,{children:["Run the batch file in ",(0,i.jsx)(n.code,{children:"etc/batches/Run-Migrations.bat"})," to apply the seeding data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't forget commas"})," between JSON objects - missing commas will result in empty tables"]}),"\n"]}),"\n",(0,i.jsxs)(n.h5,{id:"a-update-featuresjson",children:["a. Update ",(0,i.jsx)(n.code,{children:"Features.json"})]}),"\n",(0,i.jsx)(n.p,{children:"Add the new feature:"}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "Id": 25,\r\n  "Key": "Books",\r\n  "Name": "Books Feature",\r\n  "Description": "Books Feature",\r\n  "LimitType": 1,\r\n  "MaxPlanLimitValue": 0,\r\n  "LimitUnit": "",\r\n  "IsActive": true,\r\n  "FeatureGroupId": null,\r\n  "SortOrder": 25\r\n}\n'})})}),"\n",(0,i.jsxs)(n.h5,{id:"b-update-featurerolesjson",children:["b. Update ",(0,i.jsx)(n.code,{children:"FeatureRoles.json"})]}),"\n",(0,i.jsx)(n.p,{children:"Map the new feature to the role:"}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "Id": 19,\r\n  "RoleId": 21,\r\n  "FeatureId": 25\r\n}\n'})})}),"\n",(0,i.jsx)(n.h4,{id:"apply-changes",children:"Apply Changes"}),"\n",(0,i.jsx)(n.p,{children:"After updating all JSON files:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Make sure all modified JSON files have "Copy to Output Directory" set to "Copy always"'}),"\n",(0,i.jsx)(n.li,{children:"Rebuild the migrator project"}),"\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"etc/batches/Run-Migrations.bat"})," to apply the seeding data"]}),"\n",(0,i.jsx)(n.li,{children:"After seeding is complete, remember to return the 'Copy to Output Directory' property back to its original setting in all JSON files"}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{title:"Important Subscription Setup",type:"danger",children:[(0,i.jsx)(n.p,{children:"The feature will not be displayed to tenants automatically! You must:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Add subscriptions for the new feature in the Host"}),"\n",(0,i.jsx)(n.li,{children:"Add pricing for the feature from the Features screen"}),"\n",(0,i.jsx)(n.li,{children:"Assign the feature to tenants that need to use it"}),"\n"]}),(0,i.jsx)(n.p,{children:"Without completing these steps, tenants won't be able to access the Books feature even if all code and permissions are properly set up."})]}),"\n",(0,i.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,i.jsxs)(n.p,{children:["Create the following endpoint structure in ",(0,i.jsx)(n.code,{children:"UW.Platform.TenantApi.UseCases"}),":"]}),"\n",(0,i.jsx)(l.A,{title:"Structure",url:"",language:"text",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"Book/\r\n\u251c\u2500\u2500 CreateBook/\r\n\u2502   \u251c\u2500\u2500 Endpoint.cs\r\n\u2502   \u251c\u2500\u2500 Handler.cs\r\n\u2502   \u251c\u2500\u2500 Mapper.cs\r\n\u2502   \u2514\u2500\u2500 Validator.cs\r\n\u251c\u2500\u2500 GetBook/\r\n\u2502   \u251c\u2500\u2500 Endpoint.cs\r\n\u2502   \u2514\u2500\u2500 Handler.cs\r\n\u251c\u2500\u2500 GetBookList/\r\n\u2502   \u251c\u2500\u2500 Endpoint.cs\r\n\u2502   \u2514\u2500\u2500 Handler.cs\r\n\u251c\u2500\u2500 UpdateBook/\r\n\u2502   \u251c\u2500\u2500 Endpoint.cs\r\n\u2502   \u251c\u2500\u2500 Handler.cs\r\n\u2502   \u2514\u2500\u2500 Validator.cs\r\n\u2514\u2500\u2500 DeleteBook/\r\n    \u251c\u2500\u2500 Endpoint.cs\r\n    \u2514\u2500\u2500 Handler.cs\n"})})}),"\n",(0,i.jsx)(n.p,{children:"Example implementation for CreateBook endpoint:"}),"\n",(0,i.jsx)(n.admonition,{title:"Explaination",type:"info",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Endpoint"})," Class:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Handles POST /books requests."}),"\n",(0,i.jsx)(n.li,{children:"Requires Books.Add permission."}),"\n",(0,i.jsx)(n.li,{children:"Checks if the Books feature is enabled for the tenant."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"HandleAsync"})," Method:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Processes the request via handler."}),"\n",(0,i.jsx)(n.li,{children:"Encrypts and sends the response asynchronously."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Request"})," Class:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Contains book details: Name, Type, PublishDate, and Price."}),"\n",(0,i.jsxs)(n.li,{children:["Implements IEncryptedDto for encryption compliance.\r\nYou can check FastEndpoints Documentation",(0,i.jsx)(n.a,{href:"https://fast-endpoints.com",children:"link"})," for get familiar."]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Endpoint.cs:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'public class Endpoint(Handler handler) : Endpoint<Request, string>\r\n{\r\n    public override void Configure()\r\n    {\r\n        Post("books");\r\n        Permissions(TenantPermissions.Books.Add);\r\n        this.CheckFeatureLimitPreprocessor(AppFeatures.Books);\r\n    }\r\n\r\n    public override async Task HandleAsync(Request req, CancellationToken ct)\r\n    {\r\n        var response = await handler.HandleAsync(req, ct);\r\n\r\n        await SendAsync(Utils.Encrypt(response), cancellation: ct);\r\n    }\r\n}\n'})})}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class Request : IEncryptedDto\r\n{\r\n    public string Name { get; set; } = null!;\r\n\r\n    public string Type { get; set; } = null!;\r\n\r\n    public DateTime PublishDate { get; set; }\r\n\r\n    public decimal Price { get; set; }\r\n}\n"})})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Handler.cs:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'public class Handler(\r\n    IAppDbContext dbContext,\r\n    Mapper mapper,\r\n    IApplicationInfo applicationInfo,\r\n    IStringLocalizer<Handler> l) : IScopedHandler\r\n{\r\n    public async Task<int> HandleAsync(Request req, CancellationToken ct = default)\r\n    {\r\n        var tenantId = applicationInfo.TenantInfo!.Id;\r\n\r\n        var validation = ValidationContext.Instance;\r\n        var type = Enum.TryParse<BookTypeEnum>(req.Type, out var validType);\r\n        if (!type)\r\n            validation.ThrowError(l["ErrorMessage.InvalidBookType"]);\r\n\r\n        var book = mapper.ToEntity(req);\r\n        book.Type = validType;\r\n\r\n        dbContext.Books.Add(book);\r\n        await dbContext.SaveChangesAsync(ct);\r\n\r\n        await EventHelper.CreateTenantFeatureConsumedEvent(FeatureEnum.Books, tenantId).PublishAsync(cancellation: ct);\r\n        return book.Id;\r\n    }\r\n}\n'})})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Mapper.cs:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class Mapper : RequestMapper<Request, Domain.Entities.Book>\r\n{\r\n    public override Domain.Entities.Book ToEntity(Request e)\r\n    {\r\n        return new Domain.Entities.Book()\r\n        {\r\n            Name = e.Name,\r\n            Price = e.Price,\r\n            PublishDate = e.PublishDate\r\n        };\r\n    }\r\n}\n"})})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Validator.cs:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"csharp",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public class Validator : Validator<Request>\r\n{\r\n    public Validator()\r\n    {\r\n        RuleFor(x => x.Name)\r\n            .MaximumLength((StringLength.L50))\r\n            .NotNull();\r\n\r\n        RuleFor(x => x.Price)\r\n            .NotNull();\r\n\r\n        RuleFor(x => x.Type)\r\n            .NotNull();\r\n    }\r\n}\n"})})}),"\n",(0,i.jsx)(n.h2,{id:"localization",children:"Localization"}),"\n",(0,i.jsxs)(n.p,{children:["Add localizations in ",(0,i.jsx)(n.code,{children:"UW.Platform.TenantApi.Localizations"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"ar.json:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "ErrorMessage.BookNotExist": "\u0627\u0644\u0643\u062a\u0627\u0628 \u063a\u064a\u0631 \u0645\u0648\u062c\u0648\u062f\u0629",\r\n  "ErrorMessage.InvalidBookType": "\u062e\u0637\u0623 \u0628\u0646\u0648\u0639 \u0627\u0644\u0643\u062a\u0627\u0628"\r\n}\n'})})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"en.json:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"https:localhost:4100",language:"json",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "ErrorMessage.BookNotExist": "Book Not Exist",\r\n  "ErrorMessage.InvalidBookType": "Invalid Book Type"\r\n}\n'})})}),"\n",(0,i.jsx)(n.h2,{id:"testing-optional",children:"Testing (Optional)"}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Option 1:"})," ",(0,i.jsx)(n.code,{children:"Aspire-Based Deployment"}),":"]}),"\n"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Configure Aspire as the startup project in your development environment","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Aspire is Microsoft's new cloud-ready application platform that offers several key advantages:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unified orchestration of distributed applications"}),"\n",(0,i.jsx)(n.li,{children:"Built-in service discovery and configuration management"}),"\n",(0,i.jsx)(n.li,{children:"Integrated monitoring and diagnostics"}),"\n",(0,i.jsx)(n.li,{children:"Simplified local development experience"}),"\n",(0,i.jsx)(n.li,{children:"Cloud-native deployment readiness"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Option 2: ",(0,i.jsx)(n.code,{children:"Traditional Web API Deployment"}),":"]}),"\n"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Make TenantApi Project as startup Project and run it separately But this way be running  with Identity Server  so you need to run it also to get the token."}),"\n"]})]}),"\n",(0,i.jsx)(n.h3,{id:"testing-steps",children:"Testing Steps:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Make Aspire as Startup Project:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.img,{alt:"Aspire",src:s(4159).A+"",width:"594",height:"522"})}),"\n"]})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Lunch the application:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.img,{alt:"Aspire",src:s(3178).A+"",width:"1920",height:"960"})}),"\n"]})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["Click in Tenant Client Project ",(0,i.jsx)(n.code,{children:"https://localhost:4200"})]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Select the Current tenant as ",(0,i.jsx)(n.code,{children:"t1"})]}),"\n",(0,i.jsxs)(n.li,{children:["Email: ",(0,i.jsx)(n.code,{children:"t1@t.com"})]}),"\n",(0,i.jsxs)(n.li,{children:["Password: ",(0,i.jsx)(n.code,{children:"P@ssw0rd"})]}),"\n"]})}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"login",src:s(9901).A+"",width:"1296",height:"590"})})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Open Developer Tools and go to Network tab and go to any page and check the response:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Network",src:s(3875).A+"",width:"1896",height:"536"})})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Copy the token and scroll down you will see X-TenantId Header copy it also we will need it in postman:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"login",src:s(9577).A+"",width:"462",height:"358"})})}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsxs)(n.li,{children:["Open Postman and create a new request and paste the token in Authorization tab ",(0,i.jsx)(n.code,{children:"Bearer Token"})," :"]}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"login",src:s(8456).A+"",width:"1486",height:"636"})})}),"\n",(0,i.jsxs)(n.ol,{start:"7",children:["\n",(0,i.jsx)(n.li,{children:"open Header tab and paste the X-TenantId Header:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"login",src:s(2057).A+"",width:"1480",height:"349"})})}),"\n",(0,i.jsxs)(n.ol,{start:"8",children:["\n",(0,i.jsx)(n.li,{children:"click on send and you will see the response:"}),"\n"]}),"\n",(0,i.jsx)(l.A,{title:"",url:"How to test endpoint",language:"image",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"login",src:s(6107).A+"",width:"1496",height:"267"})})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var t=s(6540);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},8456:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/PostmanAuth-471aac591bfb9037202157bb305e637f.PNG"},9577:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/tenantid-dee2b8296ec96564f44ce9379efe4b12.PNG"},9901:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/IdentityServer-418215b57f1cbc5f20c61b6df6e21597.png"}}]);